<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>mist-list demo</title>

    <script src="../node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>

    <script type="module">
       import '@polymer/iron-demo-helpers/demo-pages-shared-styles';
       import '@polymer/iron-demo-helpers/demo-snippet';
    </script>

    <script type="module" src="../mist-list.js"></script>

    <custom-style>
      <style is="custom-style" include="demo-pages-shared-styles">
        mist-list  {height: 400px;}
      </style>
    </custom-style>
  </head>
  <body>
    <div class="vertical-section-container centered">
      <h3>Basic mist-list demo</h3>
      <demo-snippet>
        <template>
          <mist-list id="demo1"></mist-list>
          <script>
            window.addEventListener("WebComponentsReady", () => {
              document.querySelector("mist-list#demo1").items = [
                {"first_name":"John", "last_name":"Smith", "position": "Obergruppenführer"},
                {"first_name":"Juliana","last_name":"Crain"},
                {"first_name":"Frank","last_name":"Frink"},
                {"first_name":"Joe","last_name":"Blake", "position": "SS Agent"},
                {"first_name":"Robert","last_name":"Childan"},
                {"first_name":"Takeshi","last_name":"Kido", "position": "Inspector"},
              ];
              document.querySelector("mist-list#demo1").visible = ["first_name","last_name", "position"];
            });
          </script>
        </template>
      </demo-snippet>
    </div>
    <div class="vertical-section-container centered">
        <h3>Initialize mist-list using item-map</h3>
        <demo-snippet>
          <template>
            <mist-list id="demo2"></mist-list>
            <script>
              window.addEventListener("WebComponentsReady", () => {
                document.querySelector("mist-list#demo2").itemMap = {
                  "john-smith": {"first_name":"John", "last_name":"Smith", "position": "Obergruppenführer"},
                  "juliana-crain": {"first_name":"Juliana","last_name":"Crain"},
                  "frank-frink": {"first_name":"Frank","last_name":"Frink"},
                  "joe-blake": {"first_name":"Joe","last_name":"Blake", "position": "SS Agent"},
                  "robert-childan": {"first_name":"Robert","last_name":"Childan"},
                  "takeshi-kido": {"first_name":"Takeshi","last_name":"Kido", "position": "Inspector"},
                };
                document.querySelector("mist-list#demo2").visible = ["last_name", "position"];
              });
            </script>
          </template>
        </demo-snippet>
      </div>
      <div class="vertical-section-container centered">
        <h3>Mist-list with a column menu</h3>
        <demo-snippet>
          <template>
            <mist-list id="demo3"></mist-list>
            <script>
              window.addEventListener("WebComponentsReady", () => {
                document.querySelector("mist-list#demo3").columnMenu = true;
                document.querySelector("mist-list#demo3").items = [
                  {"first_name":"John", "last_name":"Smith", "position": "Obergruppenführer"},
                ];
                document.querySelector("mist-list#demo3").frozen = ["first_name"];
                document.querySelector("mist-list#demo3").visible = ["last_name"];
              });
            </script>
          </template>
        </demo-snippet>
      </div>
      <div class="vertical-section-container centered">
        <h3>Initialize mist-list with expandable items</h3>
        <demo-snippet>
          <template>
            <mist-list id="demo4"></mist-list>
            <script>
              window.addEventListener("WebComponentsReady", () => {
                document.querySelector("mist-list#demo4").expands = true;
                document.querySelector("mist-list#demo4").itemMap = {
                  "john-smith": {"first_name":"John", "last_name":"Smith", "position": "Obergruppenführer", "test": ["a","b"]},
                  "juliana-crain": {"first_name":"Juliana","last_name":"Crain"},
                  "frank-frink": {"first_name":"Frank","last_name":"Frink"},
                  "joe-blake": {"first_name":"Joe","last_name":"Blake", "position": "SS Agent"},
                  "robert-childan": {"first_name":"Robert","last_name":"Childan"}
                };
                document.querySelector("mist-list#demo4").visible = ["last_name", "position"];
              });
            </script>
          </template>
        </demo-snippet>
      </div>
      <div class="vertical-section-container centered">
        <h3>Initialize mist-list with toolbar and search input </h3>
        <demo-snippet>
          <template>
            <mist-list id="demo5"></mist-list>
            <script>
              window.addEventListener("WebComponentsReady", () => {
                document.querySelector("mist-list#demo5").toolbar = true;
                document.querySelector("mist-list#demo5").searchable = true;
                document.querySelector("mist-list#demo5").itemMap = {
                  "john-smith": {"first_name":"John", "last_name":"Smith", "position": "Obergruppenführer", "test": ["a","b"]},
                  "juliana-crain": {"first_name":"Juliana","last_name":"Crain"},
                  "frank-frink": {"first_name":"Frank","last_name":"Frink"},
                  "joe-blake": {"first_name":"Joe","last_name":"Blake", "position": "SS Agent"},
                  "robert-childan": {"first_name":"Robert","last_name":"Childan"}
                };
                document.querySelector("mist-list#demo5").visible = ["last_name", "position"];
              });
            </script>
          </template>
        </demo-snippet>
      </div>
      <div class="vertical-section-container centered">
        <h3>Initialize mist-list with selection and actions</h3>
        <demo-snippet>
          <template>
            <mist-list id="demo6"></mist-list>
            <script>
              window.addEventListener("WebComponentsReady", () => {
                // document.querySelector("mist-list#demo6").rest = true;
                document.querySelector("mist-list#demo6").selectable = true;
                document.querySelector("mist-list#demo6").primaryFieldName = "first_name";
                document.querySelector("mist-list#demo6").actions = [{
                    'name': 'favorite',
                    'icon': 'icons:favorite-border',
                    'confirm': false,
                    'multi': false,
                    'single': true
                },{
                    'name': 'create snapshot',
                    'icon': 'icons:attachment',
                    'confirm': true,
                    'multi': false
                },{
                    'name': 'remove snapshot',
                    'icon': 'icons:eject',
                    'confirm': true,
                    'multi': false
                },{
                    'name': 'revert to snapshot',
                    'icon': 'icons:flight-takeoff',
                    'confirm': true,
                    'multi': false
                },{
                    'name': 'shell',
                    'confirm': false,
                    'multi': true
                }]
                document.querySelector("mist-list#demo6").itemMap = {
                  "john-smith": {"id":"john-smith", "first_name":"John", "last_name":"Smith", "position": "Obergruppenführer", "hasChildren": true},
                  "juliana-crain": {"id":"juliana-crain", "first_name":"Juliana","last_name":"Crain", "parentUuid": "John"},
                  "frank-frink": {"id":"frank-frink", "first_name":"Frank","last_name":"Frink"},
                  "joe-blake": {"id":"joe-blake", "first_name":"Joe","last_name":"Blake", "position": "SS Agent"},
                  "robert-childan": {"id":"robert-childan", "first_name":"Robert","last_name":"Childan"}
                };
                document.querySelector("mist-list#demo6").visible = ["last_name", "position"];
              });
            </script>
          </template>
        </demo-snippet>
      </div>
      <div class="vertical-section-container centered">
        <h3>Initialize mist-list with tree items</h3>
        <demo-snippet>
          <template>
            <mist-list id="demo7"></mist-list>
            <script>
              const items = [
                    {"uuid": "1", "first_name":"John", "last_name":"Smith", "position": "Obergruppenführer", "hasChildren": true},
                    {"uuid": "2", "first_name":"Juliana","last_name":"Crain", "parentUuid": "1", "hasChildren": false},
                    {"uuid": "3", "first_name":"Frank","last_name":"Frink","hasChildren": false},
                    {"uuid": "4", "first_name":"Joe","last_name":"Blake", "position": "SS Agent","hasChildren": false},
                    {"uuid": "5", "first_name":"Robert","last_name":"Childan","hasChildren": false}
              ];
              window.Vaadin = window.Vaadin || {};
              window.Vaadin.GridDemo = window.Vaadin.GridDemo || {};
              window.Vaadin.GridDemo._treeData = items;
              window.Vaadin.GridDemo._getExpensesCategories = function(parentUuid, callback) {
                callback(window.Vaadin.GridDemo._treeData.filter(function(expense) {
                  if (parentUuid) {
                    return expense.parentUuid === parentUuid;
                  } else {
                    return !expense.parentUuid;
                  }
                }));
              };

              window.addEventListener("WebComponentsReady", () => {
                const list = document.querySelector("mist-list#demo7")
                list.toolbar = true;
                list.searchable = true; // TODO: search seems not to work with tree grid
                list.selectable = true; // TODO: select-all seems not to work with tree grid
                list.visible = ["last_name", "position"];
                list.frozen = ["first_name"];
                list.shadowRoot.querySelector('#grid').dataProvider = function(params, callback) {
                  // If the data request concerns a tree sub-level, `params` has an additional
                  // `parentItem` property that refers to the sub-level's parent item
                  const parentUuid = params.parentItem ? params.parentItem.uuid : null;

                  // Demo helper API that fetches expenses categories
                  Vaadin.GridDemo._getExpensesCategories(parentUuid, function(categories) {
                    // Here `categories` is an array consisting of items with the following structure:
                    // {
                    //   hasChildren: false
                    //   name: "Service fees",
                    //   uuid: "e78b"
                    //   parentUuid: "e789"
                    // }
                    // This demo uses the `hasChildren` flag as an indicator of the item having child items.
                    // The property is used internally by the `<vaadin-grid-tree-column>`.

                    // Slice out only the requested items
                    const startIndex = params.page * params.pageSize;
                    const pageItems = categories.slice(startIndex, startIndex + params.pageSize);
                    // Inform grid of the requested tree level's full size
                    const treeLevelSize = categories.length;
                    callback(pageItems, treeLevelSize);
                  });
                };
              });
              </script>
          </template>
        </demo-snippet>
      </div>
  </body>
</html>